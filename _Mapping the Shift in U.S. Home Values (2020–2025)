{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "52881068",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:11: FutureWarning: The geopandas.dataset module is deprecated and will be removed in GeoPandas 1.0. You can get the original 'naturalearth_lowres' data from https://www.naturalearthdata.com/downloads/110m-cultural-vectors/.\n",
      "  shapefile_url = gpd.datasets.get_path(\"naturalearth_lowres\")  # Built-in\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:25: FutureWarning: The geopandas.dataset module is deprecated and will be removed in GeoPandas 1.0. You can get the original 'naturalearth_lowres' data from https://www.naturalearthdata.com/downloads/110m-cultural-vectors/.\n",
      "  usa = gpd.read_file(gpd.datasets.get_path(\"naturalearth_lowres\"))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:35: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.\n",
      "  cmap = cm.get_cmap(\"viridis\")\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_28060\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "GIF saved as zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.colors import Normalize\n",
    "from matplotlib import cm\n",
    "import imageio\n",
    "import os\n",
    "\n",
    "# Paths\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "shapefile_url = gpd.datasets.get_path(\"naturalearth_lowres\")  # Built-in\n",
    "output_folder = \"zhvi_maps\"\n",
    "gif_output = \"zhvi_trend.gif\"\n",
    "\n",
    "# Load ZHVI data\n",
    "df = pd.read_csv(csv_path)\n",
    "\n",
    "# Melt to long format\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "\n",
    "# Load US states shapefile\n",
    "usa = gpd.read_file(gpd.datasets.get_path(\"naturalearth_lowres\"))\n",
    "usa = usa[(usa[\"continent\"] == \"North America\") & (usa[\"name\"] == \"United States of America\")]\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]  # Lower 48 only\n",
    "\n",
    "# Prepare folder\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# Normalize color scale\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = cm.get_cmap(\"viridis\")\n",
    "\n",
    "# Draw maps for each month\n",
    "frames = []\n",
    "for date, group in df_long[df_long[\"Date\"] >= \"2020-01-01\"].groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(1, 1, figsize=(12, 8))\n",
    "    merged.plot(column=\"ZHVI\", ax=ax, legend=True, cmap=cmap, norm=norm, edgecolor=\"black\")\n",
    "    ax.set_title(f\"ZHVI by State - {date.strftime('%B %Y')}\", fontsize=15)\n",
    "    ax.axis(\"off\")\n",
    "    \n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\")\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# Save GIF\n",
    "imageio.mimsave(gif_output, frames, duration=0.5)\n",
    "print(f\"GIF saved as {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2e4a354d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: pandas in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (2.2.2)\n",
      "Requirement already satisfied: geopandas in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (0.14.4)\n",
      "Requirement already satisfied: matplotlib in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (3.9.1)\n",
      "Requirement already satisfied: imageio in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (2.26.0)\n",
      "Requirement already satisfied: numpy>=1.23.2 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from pandas) (1.26.4)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from pandas) (2.8.2)\n",
      "Requirement already satisfied: pytz>=2020.1 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from pandas) (2023.3.post1)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from pandas) (2023.3)\n",
      "Requirement already satisfied: fiona>=1.8.21 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from geopandas) (1.9.6)\n",
      "Requirement already satisfied: packaging in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from geopandas) (23.1)\n",
      "Requirement already satisfied: pyproj>=3.3.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from geopandas) (3.6.1)\n",
      "Requirement already satisfied: shapely>=1.8.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from geopandas) (2.0.4)\n",
      "Requirement already satisfied: contourpy>=1.0.1 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (1.0.5)\n",
      "Requirement already satisfied: cycler>=0.10 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (0.11.0)\n",
      "Requirement already satisfied: fonttools>=4.22.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (4.25.0)\n",
      "Requirement already satisfied: kiwisolver>=1.3.1 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (1.4.4)\n",
      "Requirement already satisfied: pillow>=8 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (9.4.0)\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from matplotlib) (3.0.9)\n",
      "Requirement already satisfied: attrs>=19.2.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (22.1.0)\n",
      "Requirement already satisfied: certifi in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (2023.7.22)\n",
      "Requirement already satisfied: click~=8.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (8.0.4)\n",
      "Requirement already satisfied: click-plugins>=1.0 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (1.1.1)\n",
      "Requirement already satisfied: cligj>=0.5 in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (0.7.2)\n",
      "Requirement already satisfied: six in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from fiona>=1.8.21->geopandas) (1.16.0)\n",
      "Requirement already satisfied: colorama in c:\\users\\nimith narapareddy\\anaconda3\\lib\\site-packages (from click~=8.0->fiona>=1.8.21->geopandas) (0.4.6)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install pandas geopandas matplotlib imageio\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ec0128ff",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:11: FutureWarning: The geopandas.dataset module is deprecated and will be removed in GeoPandas 1.0. You can get the original 'naturalearth_lowres' data from https://www.naturalearthdata.com/downloads/110m-cultural-vectors/.\n",
      "  shapefile_url = gpd.datasets.get_path(\"naturalearth_lowres\")  # Built-in\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:25: FutureWarning: The geopandas.dataset module is deprecated and will be removed in GeoPandas 1.0. You can get the original 'naturalearth_lowres' data from https://www.naturalearthdata.com/downloads/110m-cultural-vectors/.\n",
      "  usa = gpd.read_file(gpd.datasets.get_path(\"naturalearth_lowres\"))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:35: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.\n",
      "  cmap = cm.get_cmap(\"viridis\")\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n",
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\1612442761.py:50: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.\n",
      "  frames.append(imageio.imread(frame_path))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "GIF saved as zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.colors import Normalize\n",
    "from matplotlib import cm\n",
    "import imageio\n",
    "import os\n",
    "\n",
    "# Paths\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "shapefile_url = gpd.datasets.get_path(\"naturalearth_lowres\")  # Built-in\n",
    "output_folder = \"zhvi_maps\"\n",
    "gif_output = \"zhvi_trend.gif\"\n",
    "\n",
    "# Load ZHVI data\n",
    "df = pd.read_csv(csv_path)\n",
    "\n",
    "# Melt to long format\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "\n",
    "# Load US states shapefile\n",
    "usa = gpd.read_file(gpd.datasets.get_path(\"naturalearth_lowres\"))\n",
    "usa = usa[(usa[\"continent\"] == \"North America\") & (usa[\"name\"] == \"United States of America\")]\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]  # Lower 48 only\n",
    "\n",
    "# Prepare folder\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# Normalize color scale\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = cm.get_cmap(\"viridis\")\n",
    "\n",
    "# Draw maps for each month\n",
    "frames = []\n",
    "for date, group in df_long[df_long[\"Date\"] >= \"2020-01-01\"].groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(1, 1, figsize=(12, 8))\n",
    "    merged.plot(column=\"ZHVI\", ax=ax, legend=True, cmap=cmap, norm=norm, edgecolor=\"black\")\n",
    "    ax.set_title(f\"ZHVI by State - {date.strftime('%B %Y')}\", fontsize=15)\n",
    "    ax.axis(\"off\")\n",
    "    \n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\")\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# Save GIF\n",
    "imageio.mimsave(gif_output, frames, duration=0.5)\n",
    "print(f\"GIF saved as {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "bda1b00e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ GIF saved as C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.colors import Normalize\n",
    "import matplotlib.pyplot as plt\n",
    "import imageio.v2 as imageio\n",
    "import os\n",
    "\n",
    "# Load your data\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "df = pd.read_csv(csv_path)\n",
    "\n",
    "# Transform data\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "\n",
    "# US States GeoData\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]\n",
    "\n",
    "# Prepare output\n",
    "output_folder = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_maps\"\n",
    "gif_output = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\"\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# Plot settings\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = plt.colormaps[\"viridis\"]\n",
    "frames = []\n",
    "\n",
    "# Generate frames\n",
    "for date, group in df_long[df_long[\"Date\"] >= \"2020-01-01\"].groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(1, 1, figsize=(12, 8))\n",
    "    merged.plot(column=\"ZHVI\", ax=ax, legend=True, cmap=cmap, norm=norm, edgecolor=\"black\")\n",
    "    ax.set_title(f\"ZHVI by State - {date.strftime('%B %Y')}\", fontsize=15)\n",
    "    ax.axis(\"off\")\n",
    "\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\")\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# Create GIF\n",
    "imageio.mimsave(gif_output, frames, duration=0.5)\n",
    "print(f\"✅ GIF saved as {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "55ba30dd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ GIF saved at: C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import matplotlib.ticker as mtick\n",
    "import matplotlib.pyplot as plt\n",
    "import imageio.v2 as imageio\n",
    "import os\n",
    "\n",
    "# Setup\n",
    "output_folder = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_maps\"\n",
    "gif_output = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\"\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "frames = []\n",
    "\n",
    "# Generate map per month\n",
    "for date, group in df_long[df_long[\"Date\"] >= \"2020-01-01\"].groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(\n",
    "        column=\"ZHVI\",\n",
    "        ax=ax,\n",
    "        cmap=cmap,\n",
    "        edgecolor=\"white\",\n",
    "        linewidth=0.6,\n",
    "        legend=False,\n",
    "        norm=norm,\n",
    "    )\n",
    "\n",
    "    # Title + subtitle\n",
    "    ax.set_title(f\"Zillow Home Value Index (ZHVI) – {date.strftime('%B %Y')}\",\n",
    "                 fontsize=20, weight=\"bold\", pad=20)\n",
    "    ax.annotate(\"ZHVI = Typical home value (35th–65th percentile)\",\n",
    "                xy=(0.5, 1.02), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=12)\n",
    "\n",
    "    # Remove axes\n",
    "    ax.axis(\"off\")\n",
    "\n",
    "    # Colorbar\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "\n",
    "    # Footer\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\",\n",
    "                xy=(0.5, -0.08), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    # Save frame\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# Save as GIF\n",
    "imageio.mimsave(gif_output, frames, duration=0.6)\n",
    "print(f\"✅ GIF saved at: {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2f942346",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\3599607538.py:37: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.\n",
      "  cmap = cm.get_cmap(\"viridis\")\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ GIF created at: C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.ticker as mtick\n",
    "import imageio.v2 as imageio\n",
    "from matplotlib.colors import Normalize\n",
    "from matplotlib import cm\n",
    "import os\n",
    "\n",
    "# === File Paths ===\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "output_folder = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_maps\"\n",
    "gif_output = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\"\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# === Load Data ===\n",
    "df = pd.read_csv(csv_path)\n",
    "\n",
    "# Melt to long format\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "\n",
    "# Filter for quarterly points only (Jan, Apr, Jul, Oct)\n",
    "df_long[\"Month\"] = df_long[\"Date\"].dt.month\n",
    "df_long = df_long[df_long[\"Month\"].isin([1, 4, 7, 10])]\n",
    "df_long = df_long[df_long[\"Date\"] >= \"2020-01-01\"]\n",
    "df_long = df_long[df_long[\"Date\"] <= \"2025-05-31\"]\n",
    "\n",
    "# === Load States Shapefile ===\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]\n",
    "\n",
    "# Normalize color scale for consistent legend\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = cm.get_cmap(\"viridis\")\n",
    "\n",
    "# === Create Frames ===\n",
    "frames = []\n",
    "\n",
    "# === Static Intro Frame ===\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "ax.axis(\"off\")\n",
    "fig.patch.set_facecolor(\"white\")\n",
    "\n",
    "# Main Title\n",
    "ax.text(0.5, 0.7, \"How U.S. Home Values Evolved\", fontsize=28, weight=\"bold\", ha=\"center\")\n",
    "ax.text(0.5, 0.63, \"2020 to 2025\", fontsize=22, ha=\"center\")\n",
    "ax.text(0.5, 0.55, \"A visual journey through a turbulent housing market\", fontsize=14, ha=\"center\", style=\"italic\", color=\"gray\")\n",
    "ax.text(0.5, 0.3, \"Data: Zillow • Visualization: Nimith Reddy\", fontsize=10, ha=\"center\", color=\"gray\")\n",
    "\n",
    "intro_frame_path = os.path.join(output_folder, \"intro_frame.png\")\n",
    "plt.savefig(intro_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "frames.append(imageio.imread(intro_frame_path))\n",
    "\n",
    "# === Quarterly Map Frames ===\n",
    "for date, group in df_long.groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(\n",
    "        column=\"ZHVI\",\n",
    "        ax=ax,\n",
    "        cmap=cmap,\n",
    "        edgecolor=\"white\",\n",
    "        linewidth=0.6,\n",
    "        legend=False,\n",
    "        norm=norm,\n",
    "    )\n",
    "\n",
    "    # Title + subtitle\n",
    "    ax.set_title(f\"Zillow Home Value Index (ZHVI) – {date.strftime('%B %Y')}\",\n",
    "                 fontsize=20, weight=\"bold\", pad=20)\n",
    "    ax.annotate(\"ZHVI = Typical home value (35th–65th percentile)\",\n",
    "                xy=(0.5, 1.02), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=12)\n",
    "\n",
    "    # Remove axes\n",
    "    ax.axis(\"off\")\n",
    "\n",
    "    # Colorbar\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "\n",
    "    # Footer\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\",\n",
    "                xy=(0.5, -0.08), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    # Save frame\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# === Create GIF ===\n",
    "imageio.mimsave(gif_output, frames, duration=0.3)\n",
    "print(f\"✅ GIF created at: {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "43cd499c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ GIF created at: C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "# === Create Frames ===\n",
    "frames = []\n",
    "\n",
    "# === Static Intro Frame (will be repeated) ===\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "ax.axis(\"off\")\n",
    "fig.patch.set_facecolor(\"white\")\n",
    "\n",
    "# Main Title\n",
    "ax.text(0.5, 0.7, \"Zillow Home Value Index (ZHVI)\", fontsize=28, weight=\"bold\", ha=\"center\")\n",
    "ax.text(0.5, 0.63, \"2020 to 2025\", fontsize=22, ha=\"center\")\n",
    "ax.text(0.5, 0.55, \"A visual journey through a turbulent housing market\", fontsize=14, ha=\"center\", style=\"italic\", color=\"gray\")\n",
    "ax.text(0.5, 0.3, \"Data: Zillow • Visualization: Nimith Reddy\", fontsize=10, ha=\"center\", color=\"gray\")\n",
    "\n",
    "intro_frame_path = os.path.join(output_folder, \"intro_frame.png\")\n",
    "plt.savefig(intro_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "\n",
    "# Repeat intro frame 4x for ~1.2s delay\n",
    "intro_image = imageio.imread(intro_frame_path)\n",
    "frames.extend([intro_image] * 8)\n",
    "\n",
    "# === Map Frames (subtitle only changes) ===\n",
    "for date, group in df_long.groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(\n",
    "        column=\"ZHVI\",\n",
    "        ax=ax,\n",
    "        cmap=cmap,\n",
    "        edgecolor=\"white\",\n",
    "        linewidth=0.6,\n",
    "        legend=False,\n",
    "        norm=norm,\n",
    "    )\n",
    "\n",
    "    # Fixed title\n",
    "    ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "    # Subtitle = Date\n",
    "    ax.annotate(\n",
    "        date.strftime(\"%B %Y\"),\n",
    "        xy=(0.5, 1.02), xycoords=\"axes fraction\",\n",
    "        ha=\"center\", fontsize=13\n",
    "    )\n",
    "\n",
    "    # Remove axes\n",
    "    ax.axis(\"off\")\n",
    "\n",
    "    # Colorbar\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "\n",
    "    # Footer\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\",\n",
    "                xy=(0.5, -0.08), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    # Save frame\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# === Create GIF with faster frame speed but longer intro ===\n",
    "imageio.mimsave(gif_output, frames, duration=0.3)\n",
    "print(f\"✅ GIF created at: {gif_output}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d0b9e62d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# === Intro Frame (static) ===\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "ax.axis(\"off\")\n",
    "fig.patch.set_facecolor(\"white\")\n",
    "\n",
    "ax.text(0.5, 0.7, \"Zillow Home Value Index (ZHVI)\", fontsize=28, weight=\"bold\", ha=\"center\")\n",
    "ax.text(0.5, 0.63, \"2020 to 2025\", fontsize=22, ha=\"center\")\n",
    "ax.text(0.5, 0.55, \"A visual journey through a turbulent housing market\", fontsize=14, ha=\"center\", style=\"italic\", color=\"gray\")\n",
    "ax.text(0.5, 0.3, \"Data: Zillow • Visualization: Nimith Reddy\", fontsize=10, ha=\"center\", color=\"gray\")\n",
    "\n",
    "intro_frame_path = os.path.join(output_folder, \"intro_frame.png\")\n",
    "plt.savefig(intro_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "intro_image = imageio.imread(intro_frame_path)\n",
    "frames.extend([intro_image] * 10)  # 10 frames * 0.4s = ~4s\n",
    "\n",
    "# === Map Frames (with improved month overlay) ===\n",
    "for date, group in df_long.groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(\n",
    "        column=\"ZHVI\",\n",
    "        ax=ax,\n",
    "        cmap=cmap,\n",
    "        edgecolor=\"white\",\n",
    "        linewidth=0.6,\n",
    "        legend=False,\n",
    "        norm=norm,\n",
    "    )\n",
    "\n",
    "    ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "    # Enhanced subtitle\n",
    "    ax.annotate(\n",
    "        date.strftime(\"%B %Y\"),\n",
    "        xy=(0.5, 1.02),\n",
    "        xycoords=\"axes fraction\",\n",
    "        ha=\"center\",\n",
    "        fontsize=15,\n",
    "        fontweight='bold',\n",
    "        bbox=dict(boxstyle=\"round,pad=0.3\", fc=\"white\", ec=\"gray\", lw=1)\n",
    "    )\n",
    "\n",
    "    ax.axis(\"off\")\n",
    "\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\",\n",
    "                xy=(0.5, -0.08), xycoords=\"axes fraction\",\n",
    "                ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# === Final GIF render with slower playback\n",
    "imageio.mimsave(gif_output, frames, duration=0.4)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b85d4508",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\396539699.py:32: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.\n",
      "  cmap = cm.get_cmap(\"viridis\")\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ Final GIF saved at: C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.ticker as mtick\n",
    "import imageio.v2 as imageio\n",
    "from matplotlib.colors import Normalize\n",
    "from matplotlib import cm\n",
    "import os\n",
    "\n",
    "# === File Paths ===\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "output_folder = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_maps\"\n",
    "gif_output = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\"\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# === Load & Transform Data ===\n",
    "df = pd.read_csv(csv_path)\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "df_long[\"Month\"] = df_long[\"Date\"].dt.month\n",
    "df_long = df_long[df_long[\"Month\"].isin([1, 4, 7, 10])]\n",
    "df_long = df_long[(df_long[\"Date\"] >= \"2020-01-01\") & (df_long[\"Date\"] <= \"2025-05-31\")]\n",
    "\n",
    "# === Load Shapefile ===\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]\n",
    "\n",
    "# === Setup Plotting ===\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = cm.get_cmap(\"viridis\")\n",
    "frames = []\n",
    "\n",
    "# === Intro Frame (Repeated for Pause) ===\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "ax.axis(\"off\")\n",
    "fig.patch.set_facecolor(\"white\")\n",
    "ax.text(0.5, 0.7, \"Zillow Home Value Index (ZHVI)\", fontsize=28, weight=\"bold\", ha=\"center\")\n",
    "ax.text(0.5, 0.63, \"2020 to 2025\", fontsize=22, ha=\"center\")\n",
    "ax.text(0.5, 0.55, \"A visual journey through a turbulent housing market\", fontsize=14, ha=\"center\", style=\"italic\", color=\"gray\")\n",
    "ax.text(0.5, 0.3, \"Data: Zillow • Visualization: Nimith Reddy\", fontsize=10, ha=\"center\", color=\"gray\")\n",
    "intro_frame_path = os.path.join(output_folder, \"intro_frame.png\")\n",
    "plt.savefig(intro_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "intro_image = imageio.imread(intro_frame_path)\n",
    "frames.extend([intro_image] * 10)  # Show intro ~4s (10 * 0.4s)\n",
    "\n",
    "# === Main Map Frames ===\n",
    "for date, group in df_long.groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(column=\"ZHVI\", ax=ax, cmap=cmap, edgecolor=\"white\", linewidth=0.6, legend=False, norm=norm)\n",
    "    ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "    # Month Label (Subtitle)\n",
    "    ax.annotate(\n",
    "        date.strftime(\"%B %Y\"),\n",
    "        xy=(0.5, 1.02), xycoords=\"axes fraction\",\n",
    "        ha=\"center\", fontsize=15, fontweight='bold',\n",
    "        bbox=dict(boxstyle=\"round,pad=0.3\", fc=\"white\", ec=\"gray\", lw=1)\n",
    "    )\n",
    "\n",
    "    ax.axis(\"off\")\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\", xy=(0.5, -0.08), xycoords=\"axes fraction\", ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# === Final Highlight Frame (2025 Map) with Emphasis ===\n",
    "last_date = df_long[\"Date\"].max()\n",
    "last_group = df_long[df_long[\"Date\"] == last_date]\n",
    "merged = states.merge(last_group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "merged.plot(column=\"ZHVI\", ax=ax, cmap=cmap, edgecolor=\"white\", linewidth=0.6, legend=False, norm=norm)\n",
    "ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "# Final month label – emphasized\n",
    "ax.annotate(\n",
    "    last_date.strftime(\"%B %Y\") + \" – Current\",\n",
    "    xy=(0.5, 1.02), xycoords=\"axes fraction\",\n",
    "    ha=\"center\", fontsize=16, fontweight=\"bold\",\n",
    "    bbox=dict(boxstyle=\"round,pad=0.4\", fc=\"yellow\", ec=\"red\", lw=2, alpha=0.6)\n",
    ")\n",
    "\n",
    "ax.axis(\"off\")\n",
    "sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "sm._A = []\n",
    "cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\", xy=(0.5, -0.08), xycoords=\"axes fraction\", ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "final_frame_path = os.path.join(output_folder, \"end_frame.png\")\n",
    "plt.savefig(final_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "end_image = imageio.imread(final_frame_path)\n",
    "\n",
    "# Pause on final frame (~2s)\n",
    "frames.extend([end_image] * 5)\n",
    "\n",
    "# === Save GIF ===\n",
    "imageio.mimsave(gif_output, frames, duration=0.4)\n",
    "print(\"✅ Final GIF saved at:\", gif_output)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "be1549b7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nimith Narapareddy\\AppData\\Local\\Temp\\ipykernel_44408\\2873708410.py:32: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.\n",
      "  cmap = cm.get_cmap(\"viridis\")\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ Final GIF saved at: C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.ticker as mtick\n",
    "import imageio.v2 as imageio\n",
    "from matplotlib.colors import Normalize\n",
    "from matplotlib import cm\n",
    "import os\n",
    "\n",
    "# === File Paths ===\n",
    "csv_path = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv\"\n",
    "output_folder = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_maps\"\n",
    "gif_output = r\"C:\\Users\\Nimith Narapareddy\\OneDrive - CCHOMES\\Documents\\Python Scripts\\zhvi_trend.gif\"\n",
    "os.makedirs(output_folder, exist_ok=True)\n",
    "\n",
    "# === Load & Transform Data ===\n",
    "df = pd.read_csv(csv_path)\n",
    "df_long = df.drop(columns=[\"RegionID\", \"SizeRank\", \"RegionType\", \"StateName\"]).melt(\n",
    "    id_vars=\"RegionName\", var_name=\"Date\", value_name=\"ZHVI\"\n",
    ")\n",
    "df_long[\"Date\"] = pd.to_datetime(df_long[\"Date\"])\n",
    "df_long[\"Month\"] = df_long[\"Date\"].dt.month\n",
    "df_long = df_long[df_long[\"Month\"].isin([1, 4, 7, 10])]\n",
    "df_long = df_long[(df_long[\"Date\"] >= \"2020-01-01\") & (df_long[\"Date\"] <= \"2025-05-31\")]\n",
    "\n",
    "# === Load Shapefile ===\n",
    "states = gpd.read_file(\"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip\")\n",
    "states = states[~states[\"STUSPS\"].isin([\"AK\", \"HI\", \"PR\"])]\n",
    "\n",
    "# === Setup Plotting ===\n",
    "norm = Normalize(vmin=df_long[\"ZHVI\"].min(), vmax=df_long[\"ZHVI\"].max())\n",
    "cmap = cm.get_cmap(\"viridis\")\n",
    "frames = []\n",
    "\n",
    "# === Intro Frame (Repeated for Pause) ===\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "ax.axis(\"off\")\n",
    "fig.patch.set_facecolor(\"white\")\n",
    "ax.text(0.5, 0.7, \"Zillow Home Value Index (ZHVI)\", fontsize=28, weight=\"bold\", ha=\"center\")\n",
    "ax.text(0.5, 0.63, \"2020 to 2025\", fontsize=22, ha=\"center\")\n",
    "ax.text(0.5, 0.55, \"A visual journey through a turbulent housing market\", fontsize=14, ha=\"center\", style=\"italic\", color=\"gray\")\n",
    "ax.text(0.5, 0.3, \"Data: Zillow • Visualization: Nimith Reddy\", fontsize=10, ha=\"center\", color=\"gray\")\n",
    "intro_frame_path = os.path.join(output_folder, \"intro_frame.png\")\n",
    "plt.savefig(intro_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "intro_image = imageio.imread(intro_frame_path)\n",
    "frames.extend([intro_image] * 10)  # Show intro ~4s (10 * 0.4s)\n",
    "\n",
    "# === Main Map Frames ===\n",
    "for date, group in df_long.groupby(\"Date\"):\n",
    "    merged = states.merge(group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "    fig, ax = plt.subplots(figsize=(14, 10))\n",
    "    merged.plot(column=\"ZHVI\", ax=ax, cmap=cmap, edgecolor=\"white\", linewidth=0.6, legend=False, norm=norm)\n",
    "    ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "    # Month Label - moved down to avoid overlap\n",
    "    ax.annotate(\n",
    "        date.strftime(\"%B %Y\"),\n",
    "        xy=(0.5, 0.97),  # shifted below the title\n",
    "        xycoords=\"axes fraction\",\n",
    "        ha=\"center\",\n",
    "        fontsize=15,\n",
    "        fontweight='bold',\n",
    "        bbox=dict(boxstyle=\"round,pad=0.3\", fc=\"white\", ec=\"gray\", lw=1)\n",
    "    )\n",
    "\n",
    "    ax.axis(\"off\")\n",
    "    sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "    sm._A = []\n",
    "    cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "    cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "    cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "    ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\", xy=(0.5, -0.08), xycoords=\"axes fraction\", ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "    frame_path = os.path.join(output_folder, f\"{date.strftime('%Y-%m')}.png\")\n",
    "    plt.savefig(frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "    plt.close()\n",
    "    frames.append(imageio.imread(frame_path))\n",
    "\n",
    "# === Final Highlight Frame (May 2025) with Emphasis ===\n",
    "last_date = df_long[\"Date\"].max()\n",
    "last_group = df_long[df_long[\"Date\"] == last_date]\n",
    "merged = states.merge(last_group, how=\"left\", left_on=\"NAME\", right_on=\"RegionName\")\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(14, 10))\n",
    "merged.plot(column=\"ZHVI\", ax=ax, cmap=cmap, edgecolor=\"white\", linewidth=0.6, legend=False, norm=norm)\n",
    "ax.set_title(\"Zillow Home Value Index (ZHVI) | 2020–2025\", fontsize=20, weight=\"bold\", pad=20)\n",
    "\n",
    "# Final month label – emphasized and moved down\n",
    "ax.annotate(\n",
    "    last_date.strftime(\"%B %Y\") + \" – Current\",\n",
    "    xy=(0.5, 0.97),  # shifted below title\n",
    "    xycoords=\"axes fraction\",\n",
    "    ha=\"center\", fontsize=16, fontweight=\"bold\",\n",
    "    bbox=dict(boxstyle=\"round,pad=0.4\", fc=\"yellow\", ec=\"red\", lw=2, alpha=0.6)\n",
    ")\n",
    "\n",
    "ax.axis(\"off\")\n",
    "sm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\n",
    "sm._A = []\n",
    "cbar = fig.colorbar(sm, ax=ax, shrink=0.6, pad=0.01)\n",
    "cbar.set_label(\"Typical Home Value ($)\", fontsize=12)\n",
    "cbar.ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f\"${int(x/1000)}k\"))\n",
    "ax.annotate(\"Data: Zillow • Visualization: Nimith Reddy\", xy=(0.5, -0.08), xycoords=\"axes fraction\", ha=\"center\", fontsize=10, color=\"gray\")\n",
    "\n",
    "final_frame_path = os.path.join(output_folder, \"end_frame.png\")\n",
    "plt.savefig(final_frame_path, bbox_inches=\"tight\", dpi=100)\n",
    "plt.close()\n",
    "end_image = imageio.imread(final_frame_path)\n",
    "\n",
    "# Pause on final frame (~2s)\n",
    "frames.extend([end_image] * 5)\n",
    "\n",
    "# === Save GIF ===\n",
    "imageio.mimsave(gif_output, frames, duration=0.4)\n",
    "print(\"✅ Final GIF saved at:\", gif_output)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41b6336b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
